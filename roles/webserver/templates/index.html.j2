<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ webserver_homepage_title }}</title>
    <style>
        /* CSS avec variables Ansible int√©gr√©es */
        :root {
            --primary-color: {{ webserver_theme_color | default('#3498db') }};
            --secondary-color: #2ecc71;
            --accent-color: #e74c3c;
            --text-color: #2c3e50;
            --bg-color: #ecf0f1;
            --card-bg: #ffffff;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--bg-color) 0%, #bdc3c7 100%);
            color: var(--text-color);
            line-height: 1.6;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 40px;
            background: var(--card-bg);
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }
        
        .header h1 {
            color: var(--primary-color);
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .header .subtitle {
            color: #7f8c8d;
            font-size: 1.2em;
        }
        
        .success-badge {
            background: var(--secondary-color);
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            display: inline-block;
            margin: 20px 0;
            font-weight: bold;
        }
        
        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }
        
        .info-card {
            background: var(--card-bg);
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border-left: 4px solid var(--primary-color);
        }
        
        .info-card h3 {
            color: var(--primary-color);
            margin-bottom: 15px;
            font-size: 1.3em;
        }
        
        .info-card .value {
            font-size: 1.1em;
            font-weight: 500;
            color: var(--text-color);
        }
        
        .message-box {
            background: var(--card-bg);
            padding: 30px;
            border-radius: 10px;
            margin-bottom: 30px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border-left: 4px solid var(--secondary-color);
        }
        
        .actions {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            justify-content: center;
            margin-top: 30px;
        }
        
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 5px;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s ease;
            display: inline-block;
        }
        
        .btn-primary {
            background: var(--primary-color);
            color: white;
        }
        
        .btn-secondary {
            background: var(--secondary-color);
            color: white;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        
        .footer {
            text-align: center;
            margin-top: 40px;
            padding: 20px;
            color: #7f8c8d;
            background: var(--card-bg);
            border-radius: 10px;
        }
        
        .tech-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .tech-badge {
            background: #f8f9fa;
            padding: 10px 15px;
            border-radius: 5px;
            border-left: 3px solid var(--accent-color);
        }
        
        .code {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 15px;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            margin: 15px 0;
            overflow-x: auto;
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .actions {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- En-t√™te avec titre personnalisable -->
        <div class="header">
            <h1>{{ webserver_homepage_title }}</h1>
            <p class="subtitle">Serveur configur√© avec Ansible</p>
            <div class="success-badge">‚úÖ D√©ploiement r√©ussi !</div>
        </div>
        
        <!-- Message personnalis√© -->
        <div class="message-box">
            <h3>{{ deployment_message | default('Bienvenue !') }}</h3>
            <p>{{ webserver_homepage_message }}</p>
        </div>
        
        <!-- Informations du serveur utilisant les facts Ansible -->
        <div class="info-grid">
            <div class="info-card">
                <h3>üñ•Ô∏è Informations Serveur</h3>
                <p><strong>Nom:</strong> <span class="value">{{ inventory_hostname }}</span></p>
                <p><strong>Adresse IP:</strong> <span class="value">{{ ansible_default_ipv4.address | default('N/A') }}</span></p>
                <p><strong>Syst√®me:</strong> <span class="value">{{ ansible_os_family }} {{ ansible_distribution }}</span></p>
                <p><strong>Version:</strong> <span class="value">{{ ansible_distribution_version }}</span></p>
            </div>
            
            <div class="info-card">
                <h3>‚öôÔ∏è Configuration Web</h3>
                <p><strong>Serveur Web:</strong> <span class="value">{{ webserver_service_name }}</span></p>
                <p><strong>Port:</strong> <span class="value">{{ webserver_port }}</span></p>
                <p><strong>Document Root:</strong> <span class="value">{{ webserver_document_root }}</span></p>
                <p><strong>Utilisateur:</strong> <span class="value">{{ webserver_user }}</span></p>
            </div>
            
            <div class="info-card">
                <h3>üîß Ressources Syst√®me</h3>
                <p><strong>Architecture:</strong> <span class="value">{{ ansible_architecture }}</span></p>
                <p><strong>Processeurs:</strong> <span class="value">{{ ansible_processor_vcpus | default('N/A') }}</span></p>
                <p><strong>M√©moire:</strong> <span class="value">{{ ansible_memtotal_mb | default('N/A') }} MB</span></p>
                <p><strong>Disque racine:</strong> <span class="value">{{ ansible_mounts[0].size_total | default('N/A') | filesizeformat | default('N/A') }}</span></p>
            </div>
            
            <div class="info-card">
                <h3>üìÖ D√©ploiement</h3>
                <p><strong>Date:</strong> <span class="value">{{ ansible_date_time.date }}</span></p>
                <p><strong>Heure:</strong> <span class="value">{{ ansible_date_time.time }}</span></p>
                <p><strong>Fuseau:</strong> <span class="value">{{ ansible_date_time.tz }}</span></p>
                <p><strong>Utilisateur:</strong> <span class="value">{{ ansible_user | default('N/A') }}</span></p>
            </div>
        </div>
        
        <!-- Exemple d'utilisation de variables conditionnelles -->
        {% if webserver_ssl_enabled | default(false) %}
        <div class="info-card">
            <h3>üîí Configuration HTTPS</h3>
            <p>HTTPS activ√© sur le port {{ webserver_ssl_port }}</p>
            <p>Certificat: {{ webserver_ssl_cert_path }}</p>
        </div>
        {% endif %}
        
        <!-- Variables de d√©monstration -->
        {% if demo_feature_enabled | default(false) %}
        <div class="message-box" style="border-left-color: var(--secondary-color);">
            <h3>üß™ Variables de D√©monstration</h3>
            <p><strong>Cha√Æne:</strong> {{ demo_string | default('Non d√©finie') }}</p>
            <p><strong>Liste:</strong> 
            {% for item in demo_list | default([]) %}
                <span class="tech-badge">{{ item }}</span>
            {% endfor %}
            </p>
            <p><strong>Environnement:</strong> {{ env_name | default('Non sp√©cifi√©') | upper }}</p>
        </div>
        {% endif %}
        
        <!-- Commandes utiles -->
        <div class="info-card">
            <h3>üõ†Ô∏è Commandes Utiles</h3>
            <p>Tester ce serveur :</p>
            <div class="code">curl http://{{ ansible_default_ipv4.address | default('localhost') }}:{{ webserver_port }}</div>
            
            <p>V√©rifier le statut du service :</p>
            <div class="code">sudo systemctl status {{ webserver_service_name }}</div>
            
            <p>Voir les logs :</p>
            <div class="code">sudo journalctl -u {{ webserver_service_name }} -f</div>
        </div>
        
        <!-- Actions rapides -->
        <div class="actions">
            <a href="/info.html" class="btn btn-primary">üìä Info Syst√®me D√©taill√©e</a>
            <a href="http://{{ ansible_default_ipv4.address | default('localhost') }}:{{ webserver_port }}" class="btn btn-secondary">üîÑ Recharger</a>
        </div>
        
        <!-- Informations techniques -->
        <div class="tech-info">
            <div class="tech-badge">
                <strong>Ansible Version:</strong> {{ ansible_version.full | default('N/A') }}
            </div>
            <div class="tech-badge">
                <strong>Python:</strong> {{ ansible_python_version | default('N/A') }}
            </div>
            <div class="tech-badge">
                <strong>Kernel:</strong> {{ ansible_kernel | default('N/A') }}
            </div>
            <div class="tech-badge">
                <strong>Uptime:</strong> {{ ansible_uptime_seconds | default(0) // 3600 }}h {{ (ansible_uptime_seconds | default(0) % 3600) // 60 }}m
            </div>
        </div>
        
        <!-- Footer -->
        <div class="footer">
            <p>
                ü§ñ D√©ploy√© automatiquement avec <strong>Ansible</strong><br>
                üìö Projet d'apprentissage - <strong>{{ app_name | default('ansible-learning') }}</strong> v{{ app_version | default('1.0.0') }}<br>
                üïê Derni√®re mise √† jour: {{ ansible_date_time.iso8601 }}
            </p>
            
            {% if webserver_demo_feature | default(false) %}
            <p style="margin-top: 15px; font-size: 0.9em; opacity: 0.7;">
                üí° Cette page a √©t√© g√©n√©r√©e dynamiquement √† partir du template 
                <code>roles/webserver/templates/index.html.j2</code>
            </p>
            {% endif %}
        </div>
    </div>
    
    <!-- Script JavaScript simple pour d√©montrer l'interactivit√© -->
    <script>
        // Ajouter la date/heure de visite
        document.addEventListener('DOMContentLoaded', function() {
            const now = new Date();
            const visitTime = now.toLocaleString('fr-FR');
            
            // Cr√©er un √©l√©ment pour afficher l'heure de visite
            const visitInfo = document.createElement('div');
            visitInfo.innerHTML = `<small>üïí Page visit√©e le: ${visitTime}</small>`;
            visitInfo.style.textAlign = 'center';
            visitInfo.style.marginTop = '10px';
            visitInfo.style.opacity = '0.7';
            
            document.querySelector('.footer').appendChild(visitInfo);
            
            // Animation simple au chargement
            document.querySelectorAll('.info-card').forEach((card, index) => {
                card.style.opacity = '0';
                card.style.transform = 'translateY(20px)';
                
                setTimeout(() => {
                    card.style.transition = 'all 0.6s ease';
                    card.style.opacity = '1';
                    card.style.transform = 'translateY(0)';
                }, index * 100);
            });
        });
        
        // Fonction pour copier les commandes dans le presse-papier
        document.querySelectorAll('.code').forEach(codeBlock => {
            codeBlock.style.cursor = 'pointer';
            codeBlock.title = 'Cliquer pour copier';
            
            codeBlock.addEventListener('click', function() {
                navigator.clipboard.writeText(this.textContent).then(() => {
                    const originalBg = this.style.backgroundColor;
                    this.style.backgroundColor = '#27ae60';
                    setTimeout(() => {
                        this.style.backgroundColor = originalBg;
                    }, 500);
                });
            });
        });
    </script>
</body>
</html>